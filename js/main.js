// Generated by CoffeeScript 1.4.0
(function() {

  require(['Facebook', 'handlebars', 'underscore', 'Util', 'jquery', 'fb-sdk', 'bootstrap'], function(Facebook, Handelbars, _, Util) {
    var displayAjaxLoader, displayErrorMsg, getResultDiv, self,
      _this = this;
    self = this;
    $('.req-me').click(function() {
      var $result;
      $result = getResultDiv(this);
      displayAjaxLoader($result);
      return Facebook.login().fail(function() {
        return displayErrorMsg($result);
      }).done(function(user) {
        $('.need-me').show();
        self.userId = user.id;
        return $result.html('<p><img src="http://graph.facebook.com/' + user.username + '/picture" atl="" height="40" /> ' + user.name + '</p>');
      });
    });
    $('.req-like').click(function() {
      var $result;
      $result = getResultDiv(this);
      displayAjaxLoader($result);
      return Facebook.api('me/likes', 'get', {
        limit: 100
      }).fail(function() {
        return displayErrorMsg($result);
      }).done(function(res) {
        var twoBestLikeCategories;
        twoBestLikeCategories = Util.getTwoBestLikeCategories(res);
        return $result.html('<ul><li>' + twoBestLikeCategories.first.name + '</li><Li>' + twoBestLikeCategories.second.name + '</li></ul>');
      });
    });
    $('.req-best-status').click(function() {
      var $result;
      $result = getResultDiv(this);
      displayAjaxLoader($result);
      return Facebook.api('me/statuses', 'get', {
        limit: 1000
      }).done(function(res) {
        var twoBestStatuses;
        twoBestStatuses = Util.getTwoBestStatuses(res);
        return $result.html('<ul><li>"' + twoBestStatuses.first.name + '" (' + twoBestStatuses.first.value + ' likes)</li><li>"' + twoBestStatuses.second.name + '" (' + twoBestStatuses.second.value + ' likes)</li></ul>');
      });
    });
    $('.req-pic').click(function() {
      var $result;
      $result = getResultDiv(this);
      displayAjaxLoader($result);
      return Facebook.api('me/photos', 'get', {
        limit: 1000
      }).fail(function() {
        return displayErrorMsg($result);
      }).done(function(res) {
        var twoBestTaggers;
        twoBestTaggers = Util.getTwoBestTaggers(res, self.userId);
        return $result.html('<ul><li>' + twoBestTaggers.first.name + '</li><Li>' + twoBestTaggers.second.name + '</li></ul>');
      });
    });
    getResultDiv = function(that) {
      return $(that).parent().find('.result');
    };
    displayErrorMsg = function(div) {
      return div.html('Can\'t resolve this request. Please try again.');
    };
    return displayAjaxLoader = function(div) {
      return div.html('<img src="img/ajax-loader.gif" alt="Loading..." />');
    };
  });

}).call(this);
